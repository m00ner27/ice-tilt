<div class="player-stats-container">
  <h1 class="player-stats-title">Player Statistics</h1>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading-container">
    <p>Loading stats...</p>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading">
    <!-- Season Selector -->
    <div class="filters-container">
      <label for="season-select">Season:</label>
      <select id="season-select" [(ngModel)]="selectedSeasonId" (ngModelChange)="onSeasonChange()">
        <option value="all-seasons">All Seasons</option>
        <option *ngFor="let season of seasons" [value]="season._id">{{ season.name }}</option>
      </select>
    </div>

    <!-- Stats Tables per Division -->
    <div *ngFor="let group of groupedStats" class="division-group">
      <h2 class="division-header">{{ group.division }}</h2>
      
      <div class="player-stats-table-container">
        <table class="player-stats-table">
          <thead>
            <tr>
              <th [className]="getColumnSortClass('name')" (click)="onSortColumn('name')">Player</th>
              <th [className]="getColumnSortClass('team')" (click)="onSortColumn('team')">Team</th>
              <th [className]="getColumnSortClass('position')" (click)="onSortColumn('position')">Pos</th>
              <th [className]="getColumnSortClass('gamesPlayed')" (click)="onSortColumn('gamesPlayed')">GP</th>
              <th [className]="getColumnSortClass('goals')" (click)="onSortColumn('goals')">G</th>
              <th [className]="getColumnSortClass('assists')" (click)="onSortColumn('assists')">A</th>
              <th [className]="getColumnSortClass('points')" (click)="onSortColumn('points')">PTS</th>
              <th [className]="getColumnSortClass('plusMinus')" (click)="onSortColumn('plusMinus')">+/-</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let player of group.stats">
              <td class="player-name">
                <span class="player-number">#{{ player.number }}</span>
                {{ player.name }}
              </td>
              <td class="team-cell">
                <div class="team-info">
                  <img [src]="player.teamLogo" class="team-logo" [alt]="player.team + ' logo'">
                  {{ player.team }}
                </div>
              </td>
              <td>{{ player.position }}</td>
              <td>{{ player.gamesPlayed }}</td>
              <td>{{ player.goals }}</td>
              <td>{{ player.assists }}</td>
              <td class="points-column">{{ player.points }}</td>
              <td [ngClass]="{'positive': player.plusMinus > 0, 'negative': player.plusMinus < 0}">
                {{ player.plusMinus > 0 ? '+' : '' }}{{ player.plusMinus }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- No Stats Message -->
    <div *ngIf="groupedStats.length === 0" class="no-data-container">
      <p>No player statistics available for the selected season.</p>
    </div>
  </div>
</div>
