<div class="schedule-container">
  <h1 *ngIf="!isPreview" class="schedule-title">Game Schedule</h1>
  
  <!-- Filter options -->
  <div *ngIf="!isPreview" class="filter-container">
    <div class="filter-group">
      <label for="seasonFilter">Filter by Season:</label>
      <select 
        id="seasonFilter" 
        [(ngModel)]="filterSeason" 
        (change)="onSeasonFilterChange(filterSeason)" 
        class="filter-select"
      >
        <option value="">All Seasons</option>
        <option *ngFor="let season of seasons" [value]="season._id">{{ season.name }}</option>
      </select>
    </div>
    
          <div class="filter-group">
        <label for="teamFilter">Filter by Club:</label>
        <select 
          id="teamFilter" 
          [(ngModel)]="filterTeam" 
          (change)="onTeamFilterChange(filterTeam)" 
          class="filter-select"
        >
          <option value="">All Clubs</option>
          <option *ngFor="let team of teamOptions" [value]="team">{{ team }}</option>
        </select>
      </div>
      
      <div class="filter-group">
        <button 
          (click)="clearAllFilters()" 
          class="clear-filters-btn"
          type="button"
        >
          Clear All Filters
        </button>
      </div>
    </div>
  
  <!-- Loading state -->
  <div *ngIf="matchesLoading$ | async" class="loading-container">
    <p>Loading schedule...</p>
  </div>
  
  <!-- Schedule table -->
  <div *ngIf="!(matchesLoading$ | async) && filteredMatches.length > 0" class="schedule-table-container">
    <table class="schedule-table">
      <thead>
        <tr>
          <th (click)="onSortChange('date')" [class.sort-asc]="sortCriteria === 'date' && sortDirection === 'asc'" [class.sort-desc]="sortCriteria === 'date' && sortDirection === 'desc'">
            Date
          </th>
          <th></th>
          <th (click)="onSortChange('homeTeam')" [class.sort-asc]="sortCriteria === 'homeTeam' && sortDirection === 'asc'" [class.sort-desc]="sortCriteria === 'homeTeam' && sortDirection === 'desc'">
            <span class="header-full">Home Club</span>
            <span class="header-mobile">Home</span>
          </th>
          <th></th>
          <th>Score</th>
          <th></th>
          <th (click)="onSortChange('awayTeam')" [class.sort-asc]="sortCriteria === 'awayTeam' && sortDirection === 'asc'" [class.sort-desc]="sortCriteria === 'awayTeam' && sortDirection === 'desc'">
            <span class="header-full">Away Club</span>
            <span class="header-mobile">Away</span>
          </th>
          <th></th>
          <th><span class="header-full">Details</span><span class="header-mobile">View</span></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let match of filteredMatches">
          <td class="date-cell">
            <span class="date-full">{{ formatDate(match.date) }}</span>
            <span class="date-mobile">{{ formatDateMobile(match.date) }}</span>
          </td>
          <td class="team-cell text-right">
            <a [routerLink]="['/clubs', match.homeClub?._id]" class="team-link team-name">{{ match.homeTeam }}</a>
          </td>
          <td class="team-logo-cell">
            <img [src]="getImageUrl(match.homeClub?.logoUrl)" [alt]="match.homeTeam + ' logo'" class="team-logo">
          </td>
          <td class="wl-cell">
            <span *ngIf="getResultClass(match, match.homeTeam) === 'win'" class="win-indicator">W</span>
            <span *ngIf="getResultClass(match, match.homeTeam) === 'loss'" class="loss-indicator">L</span>
          </td>
          <td class="score-cell">
            <span *ngIf="match.homeScore === 0 && match.awayScore === 0" class="vs-text">VS</span>
            <span *ngIf="!(match.homeScore === 0 && match.awayScore === 0)" class="score">{{ match.homeScore }} - {{ match.awayScore }}</span>
          </td>
          <td class="wl-cell">
            <span *ngIf="getResultClass(match, match.awayTeam) === 'win'" class="win-indicator">W</span>
            <span *ngIf="getResultClass(match, match.awayTeam) === 'loss'" class="loss-indicator">L</span>
          </td>
          <td class="team-logo-cell">
            <img [src]="getImageUrl(match.awayClub?.logoUrl)" [alt]="match.awayTeam + ' logo'" class="team-logo">
          </td>
          <td class="team-cell text-left">
            <a [routerLink]="['/clubs', match.awayClub?._id]" class="team-link team-name">{{ match.awayTeam }}</a>
          </td>
          <td class="action-cell">
            <a [routerLink]="['/match', match.id]" class="view-button">
              <span class="button-full">View Details</span>
              <span class="button-mobile">View</span>
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <!-- No matches message -->
  <div *ngIf="!(matchesLoading$ | async) && filteredMatches.length === 0" class="no-results">
    <p>No matches found for the selected filters.</p>
  </div>
  
  <!-- View Full Schedule Link (Preview Mode) -->
  <div *ngIf="isPreview && filteredMatches.length > 0" class="view-full-schedule">
    <a routerLink="/schedule" class="view-full-btn">View Full Schedule</a>
  </div>
  
  <!-- Legend -->
  <div *ngIf="!isPreview" class="schedule-legend">
    <div class="legend-item">
      <span class="win-indicator">W</span> - Win
      <span class="loss-indicator">L</span> - Loss
    </div>
    <div class="legend-note">
      <p>* Use the filters above to view games by season and/or team</p>
      <p>* Click on column headers to sort</p>
      <p>* Click "View Details" to see match statistics</p>
    </div>
  </div>
</div>
