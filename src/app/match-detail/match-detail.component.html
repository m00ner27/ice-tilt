<div class="match-detail-container" *ngIf="match">
  <button class="back-button" (click)="goBack()">‚Üê Back</button>
  
  <div class="match-header">
    <div class="match-date">{{ formatDate(match.date) }}</div>
    <div class="match-teams">
      <div class="team home-team" [class.winner]="isTeamWinner(match.homeTeam)">
        <span class="team-name">{{ match.homeTeam }}</span>
        <span class="team-score">{{ match.homeScore }}</span>
      </div>
      <div class="vs-label">VS</div>
      <div class="team away-team" [class.winner]="isTeamWinner(match.awayTeam)">
        <span class="team-name">{{ match.awayTeam }}</span>
        <span class="team-score">{{ match.awayScore }}</span>
      </div>
    </div>
  </div>
  
  <!-- No Stats Message (only shown when truly no stats available) -->
  <div class="no-stats-message" *ngIf="noStatsMessage">
    <div class="message-content">
      <h3>üìä Statistics Information</h3>
      <p>{{ noStatsMessage }}</p>
      <div class="merged-game-info" *ngIf="isMergedGame">
        <p><strong>Processing Merged Game Statistics</strong></p>
        <p>This game was created by merging multiple EA Sports NHL 25 matches. Player statistics are being combined and should be available shortly. The final score reflects the accurate combined results from all merged games.</p>
      </div>
    </div>
  </div>
  
  <div class="match-content" *ngIf="!noStatsMessage">
    <!-- Home Team Statistics -->
    <div class="team-stats">
      <h3><img [src]="getImageUrl(match.homeClub?.logoUrl)" alt="{{ match.homeTeam }} Logo" class="team-logo-sm"> {{ match.homeTeam }} Stats</h3>
      
      <!-- Skaters -->
      <h4 *ngIf="homeTeamPlayers.length > 0">Skaters</h4>
      <table class="stats-table" *ngIf="homeTeamPlayers.length > 0">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Pos</th>
            <th>G</th>
            <th>A</th>
            <th>P</th>
            <th>+/-</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let player of homeTeamPlayers">
            <td>{{ player.number }}</td>
            <td>{{ player.name }}</td>
            <td>{{ player.position }}</td>
            <td>{{ player.goals }}</td>
            <td>{{ player.assists }}</td>
            <td>{{ player.points }}</td>
            <td [class.positive]="player.plusMinus! > 0" [class.negative]="player.plusMinus! < 0">
              {{ player.plusMinus! > 0 ? '+' + player.plusMinus : player.plusMinus }}
            </td>
          </tr>
        </tbody>
      </table>
      
      <!-- Goalies -->
      <h4 *ngIf="homeTeamGoalies.length > 0">Goalies</h4>
      <table class="stats-table" *ngIf="homeTeamGoalies.length > 0">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>SA</th>
            <th>SV</th>
            <th>SV%</th>
            <th>GA</th>
            <th>SO</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let goalie of homeTeamGoalies">
            <td>{{ goalie.number }}</td>
            <td>{{ goalie.name }}</td>
            <td>{{ goalie.shotsAgainst }}</td>
            <td>{{ goalie.saves }}</td>
            <td>{{ calculateSavePercentage(goalie.saves, goalie.shotsAgainst) }}</td>
            <td>{{ goalie.goalsAgainst }}</td>
            <td>{{ goalie.shutout }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Away Team Statistics -->
    <div class="team-stats">
      <h3><img [src]="getImageUrl(match.awayClub?.logoUrl)" alt="{{ match.awayTeam }} Logo" class="team-logo-sm"> {{ match.awayTeam }} Stats</h3>
      
      <!-- Skaters -->
      <h4 *ngIf="awayTeamPlayers.length > 0">Skaters</h4>
      <table class="stats-table" *ngIf="awayTeamPlayers.length > 0">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Pos</th>
            <th>G</th>
            <th>A</th>
            <th>P</th>
            <th>+/-</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let player of awayTeamPlayers">
            <td>{{ player.number }}</td>
            <td>{{ player.name }}</td>
            <td>{{ player.position }}</td>
            <td>{{ player.goals }}</td>
            <td>{{ player.assists }}</td>
            <td>{{ player.points }}</td>
            <td [class.positive]="player.plusMinus! > 0" [class.negative]="player.plusMinus! < 0">
              {{ player.plusMinus! > 0 ? '+' + player.plusMinus : player.plusMinus }}
            </td>
          </tr>
        </tbody>
      </table>
      
      <!-- Goalies -->
      <h4 *ngIf="awayTeamGoalies.length > 0">Goalies</h4>
      <table class="stats-table" *ngIf="awayTeamGoalies.length > 0">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>SA</th>
            <th>SV</th>
            <th>SV%</th>
            <th>GA</th>
            <th>SO</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let goalie of awayTeamGoalies">
            <td>{{ goalie.number }}</td>
            <td>{{ goalie.name }}</td>
            <td>{{ goalie.shotsAgainst }}</td>
            <td>{{ goalie.saves }}</td>
            <td>{{ calculateSavePercentage(goalie.saves, goalie.shotsAgainst) }}</td>
            <td>{{ goalie.goalsAgainst }}</td>
            <td>{{ goalie.shutout }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="loading" *ngIf="!match">
  Loading match details...
</div> 