<section class="free-agents-section mt-4">
  <div class="container">
    <h2 class="text-center mb-4">Free Agents</h2>
    
    <!-- Error message -->
    <div *ngIf="error$ | async as error" class="alert alert-danger">
      {{ error }}
    </div>

    <!-- Loading State -->
    <div *ngIf="loading$ | async" class="loading-state text-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p>Loading free agents...</p>
    </div>

    <div *ngIf="!(loading$ | async)" class="free-agents-container">
      <!-- Filters -->
      <div class="filters">
        <div class="search-box">
          <input 
            type="text" 
            [(ngModel)]="searchTerm"
            (input)="onSearchChange($event)"
            placeholder="Search by username or gamertag..."
            class="search-input"
          >
        </div>

        <div class="position-filters">
          <button 
            [class.active]="positionFilter === 'All'"
            (click)="onPositionFilterChange('All')"
          >All</button>
          <button 
            [class.active]="positionFilter === 'Forward'"
            (click)="onPositionFilterChange('Forward')"
          >Forwards</button>
          <button 
            [class.active]="positionFilter === 'Defense'"
            (click)="onPositionFilterChange('Defense')"
          >Defense</button>
          <button 
            [class.active]="positionFilter === 'Goalie'"
            (click)="onPositionFilterChange('Goalie')"
          >Goalies</button>
        </div>
      </div>

      <!-- Refresh Button -->
      <div class="text-center mb-3">
        <button 
          class="btn btn-secondary" 
          (click)="refreshData()"
          [disabled]="loading$ | async"
        >
          <i class="fas fa-sync-alt me-2"></i>
          Refresh Free Agents
        </button>
      </div>

      <!-- Free Agents List -->
      <div class="agents-list">
        <div class="agent-card" *ngFor="let player of filteredAgents">
          <div class="player-info">
            <h3>{{player.discordUsername}}<span *ngIf="player.number"> #{{player.number}}</span></h3>
            <p class="position">{{player.position}}</p>
            <p class="details">
              <span *ngIf="player.country">{{player.country}} â€¢ </span>
              <span>{{player.handedness}} Shot</span>
            </p>
            <p class="gaming-ids">
              <span *ngIf="player.psnId">
                <img src="assets/images/playstation-logo.svg" alt="PlayStation" class="platform-logo-sm">
                PSN: {{player.psnId}}
              </span>
              <span *ngIf="player.xboxGamertag">
                <img src="assets/images/xbox-logo.svg" alt="Xbox" class="platform-logo-sm">
                Xbox: {{player.xboxGamertag}}
              </span>
              <span *ngIf="player.gamertag && !player.psnId && !player.xboxGamertag">
                Gamertag: {{player.gamertag}}
              </span>
            </p>
          </div>
          <div class="action-buttons">
            <a [routerLink]="['/players', player.id]" class="view-profile">View Profile</a>
          </div>
        </div>

        <!-- No results message -->
        <div class="no-results" *ngIf="!(loading$ | async) && filteredAgents.length === 0">
          No free agents found matching your criteria
        </div>
      </div>
    </div>
  </div>
</section>
